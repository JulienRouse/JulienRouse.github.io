<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Tutorial for an Idle game with Svelte (Part3)</title>
  <meta property="og:title" content="Tutorial for an Idle game with Svelte (Part3)" />
  <meta property="og:image" content="https://www.julienrouse.com/img/me.png" />
  <meta name="description" content="Software Developer with varied interests like functional programing, Lisp languages, security and more!">
  <meta property="og:description" content="Software Developer with varied interests like functional programing, Lisp languages, security and more!" />
  <meta name="author" content="Julien Rousé">
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet">
  
  <link href="https://fonts.googleapis.com/css?family=Saira+Extra+Condensed:100,200,300,400,500,600,700,800,900" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i" rel="stylesheet">
  <link href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" rel="stylesheet">
  <link href='https://cdnjs.cloudflare.com/ajax/libs/devicons/1.8.0/css/devicons.min.css' rel='stylesheet'>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/simple-line-icons/2.4.1/css/simple-line-icons.min.css" rel="stylesheet">
  
  <link href="https://www.julienrouse.com/css/resume.css" rel="stylesheet">
  <link href="https://www.julienrouse.com/css/tweaks.css" rel="stylesheet">
  <meta name="generator" content="Hugo 0.55.0" />
  
   
  
  
  <script async defer data-domain="julienrouse.com" src="https://plausible.io/js/plausible.js"></script>

</head>
<body id="page-top">
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top" id="sideNav">
  <a class="navbar-brand js-scroll-trigger" href="#page-top">
    <span class="d-block d-lg-none">Julien Rousé</span>
    <span class="d-none d-lg-block">
      <img class="img-fluid img-profile rounded-circle mx-auto mb-2" src="/img/me.png" alt="">
    </span>
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link js-scroll-trigger" href="/#about">About</a>
      </li>
      
      
      
      
      
      
      
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="/#blog">Blog</a>
          </li>
      
    </ul>
  </div>
</nav>

  <div class="container-fluid p-0">
    
<nav aria-label="breadcrumb">
  <ol  class="breadcrumb">
    





<li class="breadcrumb-item">
  <a href="https://www.julienrouse.com/">Julien Rousé&#39;s home</a>
</li>


<li class="breadcrumb-item">
  <a href="https://www.julienrouse.com/blog/">Blog</a>
</li>


<li class="breadcrumb-item active">
  <a href="https://www.julienrouse.com/blog/tutorial-for-idle-game-svelte-part3/">Tutorial for an Idle game with Svelte (Part3)</a>
</li>

  </ol>
</nav>




<section class="resume-section p-3 p-lg-5 d-flex d-column">
  <div class="my-auto">
    <h2 class="mb-0"><span class="text-primary">Tutorial for an Idle game with Svelte (Part3)</span></h2>
    <span class="text-primary">October 18, 2019</span>
	
	
	<div id="toc-blog">
		<nav id="TableOfContents">
<ul>
<li><a href="#part3-adding-upgrades-to-the-game">Part3: Adding upgrades to the game.</a>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#upgrades">Upgrades</a>
<ul>
<li><a href="#differentiating-building-bought-and-building-total">Differentiating building bought and building total.</a></li>
<li><a href="#fixing-an-accidental-bug-feature">Fixing an accidental  <del>bug</del> feature</a></li>
<li><a href="#a-new-component-for-upgrades">A new component for upgrades</a></li>
<li><a href="#updating-the-production-to-take-into-account-upgrades">Updating the production to take into account upgrades</a></li>
<li><a href="#extending-the-upgrades-for-the-second-tier-and-adding-an-initial-cost-to-upgrades">Extending the upgrades for the second tier (and adding an initial cost to upgrades)</a></li>
<li><a href="#add-a-second-tier-building">Add a second tier building</a></li>
</ul></li>
<li><a href="#recap">Recap</a></li>
<li><a href="#going-further">Going further</a></li>
<li><a href="#what-s-next">What&rsquo;s next?</a></li>
</ul></li>
</ul>
</nav>
	</div> 
	
    
	

<h1 id="part3-adding-upgrades-to-the-game">Part3: Adding upgrades to the game.</h1>

<h2 id="introduction">Introduction</h2>

<p>This article is the third part of a tutorial aiming at discovering Svelte while building a game. I also wrote a short post on Svelte and the idea behind this tutorial. Below you can find the links to check those posts or other parts of the tutorial.</p>

<ul>
<li><a href="/blog/introduction-to-svelte/">introduction to Svelte</a></li>
<li><a href="/blog/tutorial-for-idle-game-svelte-part1/">part1: Start of the tutorial: making a Derivative Idle clone with Svelte</a></li>
<li><a href="/blog/tutorial-for-idle-game-svelte-part2/">part2: Going further with Svelte using components and props</a></li>
<li><a href="/blog/tutorial-for-idle-game-svelte-part3/">part3: Adding upgrades to the game</a></li>
</ul>

<p>In this part we will focus mostly on how to implement an upgrade system.</p>

<h2 id="upgrades">Upgrades</h2>

<p>Now we will implement upgrades for our game. Upgrades are buyable bonuses that grants bonuses to production in many way. The most straightforward is giving a multiplier bonus to the production of a building. That&rsquo;s what we will be working on right now. Note that Clicker Idle upgrades gives a bonus to buildings depending on how many specific building has been bought by the player (not the total number of building the player has, because we have buildings producing other buildings). We will have to track that number bought to implement the upgrades.</p>

<p>Also Derivative Clicker gives the same bonus to all the buildings on the same row (all the buildings on the top row are tier1 buildings, producing a currency, then tier2 buildings on the second row produces tier1 buildings and so on and so forth for tier3, tier4&hellip;).</p>

<p>An example: if the bonus is 1% bonus to tier1 building for each tier1 buildings bought, if you buy 5 &ldquo;1th Derivative&rdquo; and 5 &ldquo;Combinatorics&rdquo; buildings, you have 10% bonus to all of those buildings.</p>

<h3 id="differentiating-building-bought-and-building-total">Differentiating building bought and building total.</h3>

<p>To do that first thing is to create a variable in <code>store.js</code> to handle the new information.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* store.js */</span>
...
<span style="color:#75715e">// first level buildings
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">firstDerivativeNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">firstDerivativeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">combinatoricsNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">combinatoricsBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);

<span style="color:#75715e">// second level buildings
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secondDerivativeNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secondDerivativeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
</code></pre></td></tr></table>
</div>
</div>
<p>Now that we have that, we can define props for the buildings and adjust the template:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Building.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// imports declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// variables declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// props declaration
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">numberOfBuildingBought</span>;
  
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// functions declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateNumbers</span>(){
    ...
    <span style="color:#a6e22e">numberOfBuildingBought</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">n</span> =&gt; <span style="color:#a6e22e">n</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
  }
  
  ...
&lt;/<span style="color:#f92672">script</span>&gt;

...

&lt;<span style="color:#f92672">button</span> <span style="color:#960050;background-color:#1e0010">...</span>&gt;
  ...
  &lt;<span style="color:#f92672">p</span>&gt;Owned:{$numberOfBuilding} ({$numberOfBuildingBought})&lt;/<span style="color:#f92672">p</span>&gt;
&lt;/<span style="color:#f92672">button</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>And now we can import the new stores and pass them to our Building components:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- App.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span>, <span style="color:#a6e22e">proofs</span>, <span style="color:#a6e22e">firstDerivativeNum</span>, <span style="color:#a6e22e">firstDerivativeBoughtNum</span>, <span style="color:#a6e22e">secondDerivativeNum</span>, <span style="color:#a6e22e">secondDerivativeBoughtNum</span>, <span style="color:#a6e22e">combinatoricsNum</span>, <span style="color:#a6e22e">combinatoricsBoughtNum</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  ...
&lt;/<span style="color:#f92672">script</span>&gt;

...


&lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1th Derivative&#34;</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeBoughtNum}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Combinatorics&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{proofs}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsBoughtNum}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2nde Derivative&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeBoughtNum}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<h3 id="fixing-an-accidental-bug-feature">Fixing an accidental  <del>bug</del> feature</h3>

<p>In the last part we introduced a bug. A building&rsquo;s cost is dependent on how many of that building there are. But now that other buildings can generate buildings themselves, that&rsquo;d be better if the cost would be associated with how many buildings were bought, not how many there are in total. Because we already solved the issue of differentiating bought versus total, the fix is as simple as:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Building.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  ...
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">$numberOfBuildingBought</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span>;
  ...
&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<h3 id="a-new-component-for-upgrades">A new component for upgrades</h3>

<p>Let&rsquo;s define a new component. To do that, let&rsquo;s create a new file called <code>Upgrade.svelte</code>.</p>

<p>Their states will be:</p>

<ul>
<li>how many we bought (you can buy the same upgrade many times)</li>
<li>they will have a cost that scale of of how many we bought</li>
<li>they&rsquo;ll have a name</li>
</ul>

<p>Upgrade component has a lot in common with the Building component, it is even a subset of it. We can copy the Building component and remove what we don&rsquo;t need. (Mostly anything that has to do with producing things).</p>

<p>The result is this:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Upgrade.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">currencyToString</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./utils.js&#39;</span>
    
  <span style="color:#75715e">// props declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">name</span>;
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">numberOfUpgradeBought</span>;
    
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cantBuy</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">$money</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">$numberOfUpgradeBought</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span>;
  
  <span style="color:#75715e">// function declarations  
</span><span style="color:#75715e"></span>    
  <span style="color:#75715e">// update the value of `currencyProduced` to the store, adding `n` to it.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateMoney</span>(<span style="color:#a6e22e">n</span>){
    <span style="color:#a6e22e">money</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">m</span> =&gt; <span style="color:#a6e22e">m</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">n</span>);
  }
    
  <span style="color:#75715e">// update the values of `currencyProduced` and `numberBuildings`
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateNumbers</span>(){
    <span style="color:#a6e22e">updateMoney</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">cost</span>);
    <span style="color:#a6e22e">numberOfUpgradeBought</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">n</span> =&gt; <span style="color:#a6e22e">n</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
  }
&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">style</span>&gt;
  <span style="color:#f92672">button</span> {
    <span style="color:#66d9ef">outline</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#66d9ef">black</span>;
    <span style="color:#66d9ef">background</span>: <span style="color:#66d9ef">aquamarine</span>;
    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">pointer</span>;
  }

  <span style="color:#f92672">button</span>.<span style="color:#a6e22e">cantbuy</span> {
    <span style="color:#66d9ef">background</span>: <span style="color:#ae81ff">#555</span>;
    <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#DDD</span>;
    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">default</span>;
  }
&lt;/<span style="color:#f92672">style</span>&gt;

&lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">on:click</span><span style="color:#f92672">=</span><span style="color:#e6db74">{updateNumbers}</span> <span style="color:#a6e22e">class:cantbuy</span><span style="color:#f92672">=</span><span style="color:#e6db74">{cantBuy}</span> <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span><span style="color:#e6db74">{cantBuy}</span>&gt;
  &lt;<span style="color:#f92672">h3</span>&gt;{name}&lt;/<span style="color:#f92672">h3</span>&gt;
  &lt;<span style="color:#f92672">p</span>&gt;costs {cost}$.&lt;/<span style="color:#f92672">p</span>&gt;
  &lt;<span style="color:#f92672">p</span>&gt;Owned:{$numberOfUpgradeBought}&lt;/<span style="color:#f92672">p</span>&gt;
&lt;/<span style="color:#f92672">button</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>Then as usual we need to define new variables in the store to hold the number of upgrade bought:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* store.js */</span>
...
<span style="color:#75715e">// upgrades
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">firstRowBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
</code></pre></td></tr></table>
</div>
</div>
<p>And finally let&rsquo;s use the new component in <code>App.svelte</code>:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- App.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Upgrade</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./Upgrade.svelte&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span>, <span style="color:#a6e22e">proofs</span>, <span style="color:#a6e22e">firstDerivativeNum</span>, <span style="color:#a6e22e">firstDerivativeBoughtNum</span>, <span style="color:#a6e22e">secondDerivativeNum</span>, <span style="color:#a6e22e">secondDerivativeBoughtNum</span>, <span style="color:#a6e22e">combinatoricsNum</span>, <span style="color:#a6e22e">combinatoricsBoughtNum</span>, <span style="color:#a6e22e">firstRowBoughtNum</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  ...
    
  <span style="color:#75715e">// variable declarations
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  
  <span style="color:#75715e">// function declarations
</span><span style="color:#75715e"></span>    
  <span style="color:#75715e">// lifecycle functions
</span><span style="color:#75715e"></span>&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">style</span>&gt;
&lt;/<span style="color:#f92672">style</span>&gt;

...

&lt;<span style="color:#f92672">div</span>&gt;
    &lt;<span style="color:#f92672">Upgrade</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;First row&#34;</span> <span style="color:#a6e22e">numberOfUpgradeBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstRowBoughtNum}</span>&gt;&lt;/<span style="color:#f92672">Upgrade</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>I made another big ugly thing here, using the div around the <code>&lt;Upgrade&gt;</code> tag to push it down the page. We will refactor all those ugly bits at the end of the tutorial because let&rsquo;s face it it&rsquo;s not the most interesting things to spend time on right now. But keep in mind that this is not the nicest way to do it.</p>

<h3 id="updating-the-production-to-take-into-account-upgrades">Updating the production to take into account upgrades</h3>

<p>Now we have to modify how <code>Building.svelte</code> calculate how it produces its currency.</p>

<p>We need to have a props to know the bonus given by the upgrade.</p>

<p>Also we need to move things a bit, before we had a variable <code>buildingProduction = 1</code> which is gonna be replaced by a reactive declaration taking account the bonus given by the upgrade given as a prop, and this will impact <code>productionPerTick</code>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Building.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// variable declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// props declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">upgradeBonus</span>;

  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">buildingProduction</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">upgradeBonus</span>);
  
  ...

&lt;/<span style="color:#f92672">script</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>We used <code>Math.floor()</code> to restrict the upgrade bonus to only whole number, so if a building produce initially 10 unit of currency each tick, with a bonus of 25%, it actually produces 12 unit per tick and not 12.5. For now I will let it that way, even so the upgrade is weaker than what is advertised, it is made to deal only with Integer (Num) and not Float or Double. Another way to do this is to calculate correctly the upgrade without flooring or rounding and to only apply the rounding on the number when we display it.</p>

<p>Note also that is the formula we have twice the magic number <code>1</code> which refers to the initial number of unit produced by the building. I will let it that way for now, but in the future we will change it to allow for more flexibility when creating buildings.</p>

<p>Next we need to change <code>App.svelte</code> to calculate the upgrade bonus and pass it to the buildings. For now for each building of the first tier we will get 25% bonus. These numbers are for development purpose and will be changed when we will balance the game progression.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- App.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declaration
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// variables declaration
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">firstTierUpgradeBonusPerBuilding</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>;
  
  <span style="color:#75715e">// reactives declarations
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">firstTierBuildingBought</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$firstDerivativeBoughtNum</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">$combinatoricsBoughtNum</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">firstTierBuildingUpgradeBonus</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">firstTierBuildingBought</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">firstTierUpgradeBonusPerBuilding</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">$firstRowUpgradeBoughtNum</span>;
  
&lt;/<span style="color:#f92672">script</span>&gt;

...

&lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1th Derivative&#34;</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Combinatorics&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{proofs}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2nde Derivative&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{0}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;
    &lt;<span style="color:#f92672">Upgrade</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;First row&#34;</span> <span style="color:#a6e22e">numberOfUpgradeBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstRowUpgradeBoughtNum}</span>&gt;&lt;/<span style="color:#f92672">Upgrade</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>Great! Now we can buy upgrades for our first tier buildings :)</p>

<p>One thing that is far from perfect is <code>$: firstTierBuildingBought = $firstDerivativeBoughtNum + $combinatoricsBoughtNum;</code>. Every time we are gonna add a new tier1 building, we are gonna need to update this. For now we will keep it that way but maybe later on we will find a way to simplify this.</p>

<h3 id="extending-the-upgrades-for-the-second-tier-and-adding-an-initial-cost-to-upgrades">Extending the upgrades for the second tier (and adding an initial cost to upgrades)</h3>

<p>If you looked carefully at the last code snippet we used a placeholder for the upgrade bonus of &ldquo;2nd Derivative&rdquo; <code>&lt;Building name=&quot;2nde Derivative&quot; currencyProduced={firstDerivativeNum} numberOfBuilding={secondDerivativeNum} numberOfBuildingBought={secondDerivativeBoughtNum} upgradeBonus={0}&gt;&lt;/Building&gt;</code>.</p>

<p>That would be better to implement the upgrade for that tier of building too and it is pretty straightforward.</p>

<p>First we need to add a new value in the store:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* store.js */</span>
...
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secondRowUpgradeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
</code></pre></td></tr></table>
</div>
</div>
<p>We will also modify <code>Upgrade.svelte</code> to make the initial cost of each upgrade different and we will also change the formula for the cost:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Upgrade.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  ...
  
  <span style="color:#75715e">// props declaration
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">initialCost</span>;
  
  <span style="color:#75715e">// reactive declaration
</span><span style="color:#75715e"></span>  ...
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">initialCost</span> <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">pow</span>(<span style="color:#ae81ff">100</span>, <span style="color:#a6e22e">$numberOfUpgradeBought</span>);
  
  ...
&lt;/<span style="color:#f92672">script</span>&gt;

...</code></pre></td></tr></table>
</div>
</div>
<p>Then we can modify <code>App.svelte</code> to define the bonus for second tier building (100% bonus for each building of tier 2 bought).</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- App.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">import</span> { ..., <span style="color:#a6e22e">secondRowUpgradeBoughtNum</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  ...
  
  <span style="color:#75715e">// variable declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">secondTierUpgradeBonusPerBuilding</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
  
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">secondTierBuildingBought</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$secondDerivativeBoughtNum</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">secondTierBuildingUpgradeBonus</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">secondTierBuildingBought</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">secondTierUpgradeBonusPerBuild</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">$secondRowUpgradeBoughtNum</span>;
 
  
  ...  
&lt;/<span style="color:#f92672">script</span>&gt;

...

&lt;<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1th Derivative&#34;</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Combinatorics&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{proofs}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2nde Derivative&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">Upgrade</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;First row&#34;</span> <span style="color:#a6e22e">numberOfUpgradeBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstRowUpgradeBoughtNum}</span> <span style="color:#a6e22e">initialCost</span><span style="color:#f92672">=</span><span style="color:#e6db74">{100}</span>&gt;&lt;/<span style="color:#f92672">Upgrade</span>&gt;
  &lt;<span style="color:#f92672">Upgrade</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Second row&#34;</span> <span style="color:#a6e22e">numberOfUpgradeBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondRowUpgradeBoughtNum}</span> <span style="color:#a6e22e">initialCost</span><span style="color:#f92672">=</span><span style="color:#e6db74">{10000}</span>&gt;&lt;/<span style="color:#f92672">Upgrade</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>This time we pass an initial cost to the upgrade so that the first upgrade cost 100 time less than the second.</p>

<p>Also I put the Buildings into div to make the second tier building on a row below the first tier building. As usual, it is to not use CSS now, but at the end we&rsquo;ll do a cleanup phase to use proper semantic for HTML and use CSS when needed.</p>

<h3 id="add-a-second-tier-building">Add a second tier building</h3>

<p>A last thing before wrapping up this part, we&rsquo;ll add a second tier2 building that will produce <code>Combinatorics</code> to make things even (two tier1, two tier2 and two upgrades). To do that we need to have the proper values in <code>store.js</code> then adding the component into <code>App.svelte</code>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* store.js */</span>
...
<span style="color:#75715e">//second level buildings
</span><span style="color:#75715e"></span>...
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">probabilityNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">probabilityBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);

...
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- App.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span>, ..., , <span style="color:#a6e22e">probabilityNum</span>, <span style="color:#a6e22e">probabilityBoughtNum</span>, ...} <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  ...
  
  <span style="color:#75715e">// variable declarations
</span><span style="color:#75715e"></span>  ...
          
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  ...
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">secondTierBuildingBought</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$secondDerivativeBoughtNum</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">$probabilityBoughtNum</span>;
  ...
&lt;/<span style="color:#f92672">script</span>&gt;

...</code></pre></td></tr></table>
</div>
</div>
<p>This works fine and to finalize it, we should modify the function that display the currency the building is producing:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* utils.js */</span>
<span style="color:#66d9ef">import</span> { ..., <span style="color:#a6e22e">combinatoricsNum</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span> 

<span style="color:#75715e">// Returns a string representing `currency`. If `c` is not recognized, returns &#39;?&#39;
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">currencyToString</span>(<span style="color:#a6e22e">c</span>){
  ...
    
  ...
  <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">combinatoricsNum</span>)
    <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; Combinatorics&#34;</span>

  ...
}
</code></pre></td></tr></table>
</div>
</div>
<p>That will display nicely on the new building that he is producing &ldquo;Combinatorics&rdquo;.</p>

<h2 id="recap">Recap</h2>

<p>It&rsquo;s the end of this part, this time we implemented a new tier2 building and a basic upgrade system. The full code follows:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- App.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Building</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./Building.svelte&#39;</span>;
  <span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Upgrade</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./Upgrade.svelte&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span>, <span style="color:#a6e22e">proofs</span>, <span style="color:#a6e22e">firstDerivativeNum</span>, <span style="color:#a6e22e">firstDerivativeBoughtNum</span>, <span style="color:#a6e22e">secondDerivativeNum</span>, <span style="color:#a6e22e">secondDerivativeBoughtNum</span>, <span style="color:#a6e22e">combinatoricsNum</span>, <span style="color:#a6e22e">combinatoricsBoughtNum</span>, <span style="color:#a6e22e">probabilityNum</span>, <span style="color:#a6e22e">probabilityBoughtNum</span>, <span style="color:#a6e22e">firstRowUpgradeBoughtNum</span>, <span style="color:#a6e22e">secondRowUpgradeBoughtNum</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">currencyToString</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./utils.js&#39;</span>;
    
  <span style="color:#75715e">// variable declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">firstTierUpgradeBonusPerBuilding</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.25</span>;
  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">secondTierUpgradeBonusPerBuilding</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;

  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">firstTierBuildingBought</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$firstDerivativeBoughtNum</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">$combinatoricsBoughtNum</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">secondTierBuildingBought</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$secondDerivativeBoughtNum</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">$probabilityBoughtNum</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">firstTierBuildingUpgradeBonus</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">firstTierBuildingBought</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">firstTierUpgradeBonusPerBuilding</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">$firstRowUpgradeBoughtNum</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">secondTierBuildingUpgradeBonus</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">secondTierBuildingBought</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">secondTierUpgradeBonusPerBuilding</span>) <span style="color:#f92672">*</span> <span style="color:#a6e22e">$secondRowUpgradeBoughtNum</span>;
    
  <span style="color:#75715e">// function declarations
</span><span style="color:#75715e"></span>    
  <span style="color:#75715e">// lifecycle functions
</span><span style="color:#75715e"></span>&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">style</span>&gt;
&lt;/<span style="color:#f92672">style</span>&gt;

&lt;<span style="color:#f92672">h1</span>&gt;You have {$money}{currencyToString(money)} and {$proofs}{currencyToString(proofs)}!&lt;/<span style="color:#f92672">h1</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1th Derivative&#34;</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Combinatorics&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{proofs}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;2nde Derivative&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondDerivativeBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
  &lt;<span style="color:#f92672">Building</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Probability&#34;</span> <span style="color:#a6e22e">currencyProduced</span><span style="color:#f92672">=</span><span style="color:#e6db74">{combinatoricsNum}</span> <span style="color:#a6e22e">numberOfBuilding</span><span style="color:#f92672">=</span><span style="color:#e6db74">{probabilityNum}</span> <span style="color:#a6e22e">numberOfBuildingBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{probabilityBoughtNum}</span> <span style="color:#a6e22e">upgradeBonus</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondTierBuildingUpgradeBonus}</span>&gt;&lt;/<span style="color:#f92672">Building</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;

&lt;<span style="color:#f92672">div</span>&gt;
  &lt;<span style="color:#f92672">Upgrade</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;First row&#34;</span> <span style="color:#a6e22e">numberOfUpgradeBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{firstRowUpgradeBoughtNum}</span> <span style="color:#a6e22e">initialCost</span><span style="color:#f92672">=</span><span style="color:#e6db74">{100}</span>&gt;&lt;/<span style="color:#f92672">Upgrade</span>&gt;
  &lt;<span style="color:#f92672">Upgrade</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Second row&#34;</span> <span style="color:#a6e22e">numberOfUpgradeBought</span><span style="color:#f92672">=</span><span style="color:#e6db74">{secondRowUpgradeBoughtNum}</span> <span style="color:#a6e22e">initialCost</span><span style="color:#f92672">=</span><span style="color:#e6db74">{10000}</span>&gt;&lt;/<span style="color:#f92672">Upgrade</span>&gt;
&lt;/<span style="color:#f92672">div</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>Building:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Building.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">onMount</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;svelte&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">currencyToString</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./utils.js&#39;</span>
    
  <span style="color:#75715e">// variable declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">tickSpeed</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1000</span>;
    
  <span style="color:#75715e">// props declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">name</span>;
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">currencyProduced</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">money</span>;
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">numberOfBuilding</span>;
    <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">numberOfBuildingBought</span>;
    <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">upgradeBonus</span>;
    
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cantBuy</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">$money</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">$numberOfBuildingBought</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">5</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">buildingProduction</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">+</span> Math.<span style="color:#a6e22e">floor</span>(<span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">upgradeBonus</span>);  <span style="color:#75715e">// currency produced per building per tick
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">productionPerTick</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$numberOfBuilding</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">buildingProduction</span>;
  
  <span style="color:#75715e">// function declarations
</span><span style="color:#75715e"></span>
  <span style="color:#75715e">// update the value of `currencyProduced` to the store, adding `n` to it.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateMoney</span>(<span style="color:#a6e22e">n</span>){
    <span style="color:#a6e22e">money</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">m</span> =&gt; <span style="color:#a6e22e">m</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">n</span>);
  }
    
  <span style="color:#75715e">// update the value of `currencyProduced` to the store, adding `n` to it.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateCurrencyProduced</span>(<span style="color:#a6e22e">n</span>){
    <span style="color:#a6e22e">currencyProduced</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">m</span> =&gt; <span style="color:#a6e22e">m</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">n</span>);
  }
    
  <span style="color:#75715e">// update the values of `currencyProduced` and `numberBuildings`
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateNumbers</span>(){
    <span style="color:#a6e22e">updateMoney</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">cost</span>);
    <span style="color:#a6e22e">numberOfBuilding</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">n</span> =&gt; <span style="color:#a6e22e">n</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
    <span style="color:#a6e22e">numberOfBuildingBought</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">n</span> =&gt; <span style="color:#a6e22e">n</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
  }
    
  <span style="color:#75715e">// update `currencyProduced` with `productionPerTick` and set a timeout to call itself after `tickSpeed` ms
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">launchTimeout</span>(){
    <span style="color:#a6e22e">updateCurrencyProduced</span>(<span style="color:#a6e22e">productionPerTick</span>);
    <span style="color:#a6e22e">setTimeout</span>(<span style="color:#a6e22e">launchTimeout</span>, <span style="color:#a6e22e">tickSpeed</span>);
  }
  
  <span style="color:#75715e">// lifecycle functions
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">onMount</span>(() =&gt; {
    <span style="color:#a6e22e">launchTimeout</span>();
  }); 
&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">style</span>&gt;
  <span style="color:#f92672">button</span> {
    <span style="color:#66d9ef">outline</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#66d9ef">black</span>;
    <span style="color:#66d9ef">background</span>: <span style="color:#66d9ef">aliceblue</span>;
    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">pointer</span>;
  }

  <span style="color:#f92672">button</span>.<span style="color:#a6e22e">cantbuy</span> {
    <span style="color:#66d9ef">background</span>: <span style="color:#ae81ff">#555</span>;
    <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#DDD</span>;
    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">default</span>;
  }
&lt;/<span style="color:#f92672">style</span>&gt;

&lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">on:click</span><span style="color:#f92672">=</span><span style="color:#e6db74">{updateNumbers}</span> <span style="color:#a6e22e">class:cantbuy</span><span style="color:#f92672">=</span><span style="color:#e6db74">{cantBuy}</span> <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span><span style="color:#e6db74">{cantBuy}</span>&gt;
  &lt;<span style="color:#f92672">h3</span>&gt;{name}&lt;/<span style="color:#f92672">h3</span>&gt;
  &lt;<span style="color:#f92672">p</span>&gt;{buildingProduction}{currencyToString(currencyProduced)}/tick: costs {cost}$.&lt;/<span style="color:#f92672">p</span>&gt;
  &lt;<span style="color:#f92672">p</span>&gt;Owned:{$numberOfBuilding} ({$numberOfBuildingBought})&lt;/<span style="color:#f92672">p</span>&gt;
    
&lt;/<span style="color:#f92672">button</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>Upgrade:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html"><span style="color:#75715e">&lt;!-- Upgrade.svelte --&gt;</span>
&lt;<span style="color:#f92672">script</span>&gt;
  <span style="color:#75715e">// import declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span>;
  <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">currencyToString</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./utils.js&#39;</span>
    
  <span style="color:#75715e">// props declarations
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">name</span>;
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">numberOfUpgradeBought</span>;
  <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">initialCost</span>;
    
  <span style="color:#75715e">// reactive declarations
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cantBuy</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">$money</span>;
  <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cost</span> <span style="color:#f92672">=</span>  <span style="color:#a6e22e">initialCost</span> <span style="color:#f92672">*</span> Math.<span style="color:#a6e22e">pow</span>(<span style="color:#ae81ff">100</span>, <span style="color:#a6e22e">$numberOfUpgradeBought</span>);
  
  <span style="color:#75715e">// function declarations  
</span><span style="color:#75715e"></span>    
  <span style="color:#75715e">// update the value of `currencyProduced` to the store, adding `n` to it.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateMoney</span>(<span style="color:#a6e22e">n</span>){
    <span style="color:#a6e22e">money</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">m</span> =&gt; <span style="color:#a6e22e">m</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">n</span>);
  }
    
  <span style="color:#75715e">// update the values of `currencyProduced` and `numberBuildings`
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">updateNumbers</span>(){
    <span style="color:#a6e22e">updateMoney</span>(<span style="color:#f92672">-</span><span style="color:#a6e22e">cost</span>);
    <span style="color:#a6e22e">numberOfUpgradeBought</span>.<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">n</span> =&gt; <span style="color:#a6e22e">n</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
  }
&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">style</span>&gt;
  <span style="color:#f92672">button</span> {
    <span style="color:#66d9ef">outline</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span> <span style="color:#66d9ef">black</span>;
    <span style="color:#66d9ef">background</span>: <span style="color:#66d9ef">aquamarine</span>;
    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">pointer</span>;
  }

  <span style="color:#f92672">button</span>.<span style="color:#a6e22e">cantbuy</span> {
    <span style="color:#66d9ef">background</span>: <span style="color:#ae81ff">#555</span>;
    <span style="color:#66d9ef">color</span>: <span style="color:#ae81ff">#DDD</span>;
    <span style="color:#66d9ef">cursor</span>: <span style="color:#66d9ef">default</span>;
  }
&lt;/<span style="color:#f92672">style</span>&gt;

&lt;<span style="color:#f92672">button</span> <span style="color:#a6e22e">on:click</span><span style="color:#f92672">=</span><span style="color:#e6db74">{updateNumbers}</span> <span style="color:#a6e22e">class:cantbuy</span><span style="color:#f92672">=</span><span style="color:#e6db74">{cantBuy}</span> <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span><span style="color:#e6db74">{cantBuy}</span>&gt;
  &lt;<span style="color:#f92672">h3</span>&gt;{name}&lt;/<span style="color:#f92672">h3</span>&gt;
  &lt;<span style="color:#f92672">p</span>&gt;costs {cost}$.&lt;/<span style="color:#f92672">p</span>&gt;
  &lt;<span style="color:#f92672">p</span>&gt;Owned:{$numberOfUpgradeBought}&lt;/<span style="color:#f92672">p</span>&gt;
&lt;/<span style="color:#f92672">button</span>&gt;</code></pre></td></tr></table>
</div>
</div>
<p>store:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* store */</span>
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">writable</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;svelte/store&#39;</span>;

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">money</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">20</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">proofs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);

<span style="color:#75715e">// first level buildings
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">firstDerivativeNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">firstDerivativeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">combinatoricsNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">combinatoricsBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);

<span style="color:#75715e">// second level buildings
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secondDerivativeNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secondDerivativeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">probabilityNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">probabilityBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);

<span style="color:#75715e">// upgrades
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">firstRowUpgradeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">secondRowUpgradeBoughtNum</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">writable</span>(<span style="color:#ae81ff">0</span>);
</code></pre></td></tr></table>
</div>
</div>
<p>And finally utils:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#75715e">/* utils.js */</span>
<span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">money</span>, <span style="color:#a6e22e">proofs</span>, <span style="color:#a6e22e">firstDerivativeNum</span>, <span style="color:#a6e22e">combinatoricsNum</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;./store.js&#39;</span> 

<span style="color:#75715e">// Returns a string representing `currency`. If `currency` is not recognized, returns &#39;?&#39;
</span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">currencyToString</span>(<span style="color:#a6e22e">c</span>){
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;?&#34;</span>;

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">money</span>)
        <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;$&#34;</span>;
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">proofs</span>)
        <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; proofs&#34;</span>
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">firstDerivativeNum</span>)
        <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; 1st Derivative&#34;</span>
    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">===</span> <span style="color:#a6e22e">combinatoricsNum</span>)
        <span style="color:#a6e22e">result</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34; Combinatorics&#34;</span>

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>;
}
</code></pre></td></tr></table>
</div>
</div>
<p>The result in picture:</p>

<figure>
    <img src="/img/blog_3_part3_final_recap.png"
         alt="Result of the third part tutorial"/> 
</figure>


<p>You can also play with the game and the code in the <a href="https://svelte.dev/repl/ae7ab07c14804b9f92b631dca91bd129?version=3.4.2">Svelte REPL</a> or just enjoy <a href="http://tuto-derivative-clicker-part3.surge.sh/">the game made so far</a> (hosted by Surge).</p>

<h2 id="going-further">Going further</h2>

<p>If you want to go further and see if you understood how the game works, here is some elements you can try to add to the game:</p>

<ul>
<li>another tier1 building that cost <code>proof</code>  and generate money(and called &ldquo;Computer&rdquo; if you want to follow closely Derivative Clicker).</li>
<li>another tier2 building that costs <code>proof</code> and generates <code>Computer</code> (see the point above)  called &ldquo;Assembly line&rdquo;</li>
</ul>

<h2 id="what-s-next">What&rsquo;s next?</h2>

<p>Next article will be the conclusion on this tutorial, with resources for going further and my opinion on Svelte so far.</p>

<p>The next part is here: COMING SOON</p>

    
    <ul class="tags">
    
      <li><a class="tag" href="/tags/svelte">svelte</a></li>
    
      <li><a class="tag" href="/tags/spa">SPA</a></li>
    
      <li><a class="tag" href="/tags/game">game</a></li>
    
      <li><a class="tag" href="/tags/tutorial">tutorial</a></li>
    
      <li><a class="tag" href="/tags/idle">idle</a></li>
    
</ul>

  </div>
</section>


    <span style="color: #999999; font-size: 60%;">Nifty <a href="https://codepen.io/wbeeftink/pen/dIaDH">tech tag lists</a> from <a class="pen-owner-link" href="https://codepen.io/wbeeftink">Wouter Beeftink</a> </span>
    
  </div>
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0/js/bootstrap.bundle.min.js"></script>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
  
  <script src="js/resume.js"></script>

  

  
</body>
</html>
